import Control.Monad(foldM_)
import Data.Char(isLetter,toLower)
import Data.List(sort)
import Data.Map(Map)
import qualified Data.Map as M

key :: String -> String
key name = (sort . map toLower . filter isLetter) name

plusKey :: String -> String
plusKey name = key ('c':name)

minusKey :: String -> Maybe String
minusKey name = remove (key name)
  where
    remove [] = Nothing
    remove (c:cs) | c < 'c' = fmap (c:) (remove cs)
                  | c == 'c' = Just cs
                  | otherwise = Nothing

showHits :: Map String [String] -> String -> IO (Map String [String])
showHits names name = do
    showHit (plusKey name)
    mapM_ showHit (minusKey name)
    return (M.alter (Just . maybe [name] (name:)) (key name) names)
  where
    showHit nameKey =
        maybe (return ()) (print . (,) name) (M.lookup nameKey names)

main :: IO ()
main = foldM_ showHits M.empty [
    "General Hospital",
    "Sesame Street",
    "PBS Newhour",
    "Entertainment Tonight",
    "Noticiero Univision",
    "NFL Primetime",
    "The Simpsons",
    "Baseball Tonight",
    "Dateline NBC",
    "NFL Matchup",
    "Power Rangers",
    "The X-Files",
    "Primer Impacto",
    "Squawk Box",
    "Washington Journal",
    "Access Hollywood",
    "Judge Judy",
    "MSNBC Live",
    "Power Lunch",
    "Animal Rescue",
    "Despierta America",
    "South Park",
    "The View",
    "NFL Live",
    "True Life",
    "Family Feud",
    "Fox Report",
    "House Hunters",
    "Independent Lens",
    "Noticiero Telemundo",
    "Republica Deportiva",
    "SpongeBob SquarePants",
    "Big Brother",
    "In Depth",
    "Caso Cerrado",
    "The Bachelor",
    "Barefoot Contessa",
    "Cashin' In",
    "Closing Bell",
    "Contacto Deportivo",
    "Dr. Phil",
    "NBA Countdown",
    "Simply Ming",
    "First Look",
    "Project Runway",
    "Tavis Smiley",
    "After Words",
    "America's Heartland",
    "American Dad!",
    "Bowhunter TV",
    "College GameDay",
    "Criminal Minds",
    "Deadly Women",
    "Family Guy",
    "Grey's Anatomy",
    "Hell's Kitchen",
    "Mad Money",
    "NHL Live",
    "Saturday Primetime",
    "Fast Money",
    "NFL Replay",
    "Your Business",
    "Al Punto",
    "American Greed",
    "America's Newsroom",
    "First Take",
    "Morning Joe",
    "The Bachelorette",
    "The Doctors",
    "Ghost Adventures",
    "Happening Now",
    "Cake Boss",
    "Cupcake Wars",
    "Fault Lines",
    "The Middle",
    "Modern Family",
    "Pawn Stars",
    "Shark Tank",
    "American Pickers",
    "American Restoration",
    "Ancient Aliens",
    "Blue Bloods",
    "Drugs, Inc.",
    "Dual Survival",
    "Gold Rush",
    "Sister Wives",
    "The Talk",
    "Undercover Boss",
    "Wild Kratts",
    "Bar Rescue",
    "Bob's Burgers",
    "The Chew",
    "Dance Moms",
    "The Five",
    "Homocide Hunter",
    "Impractical Jokers",
    "Paranormal Witness",
    "Talking Dead",
    "The Voice",
    "Blood Relatives",
    "Breaking Amish",
    "Chicago Fire",
    "Counting Cars",
    "Doc McStuffins",
    "DreamWorks Dragons",
    "Hotel Hell",
    "Hotel Impossible",
    "Major Crimes",
    "Yukon Men",
    "Arrested Development",
    "Below Deck",
    "The Blacklist",
    "Cutthroat Kitchen",
    "Drunk History",
    "Food Factory",
    "The Fosters",
    "Garage Gold",
    "The Goldbergs",
    "Hawaii Life",
    "MasterChef Junior",
    "New Day",
    "NFL Insiders",
    "The Originals",
    "PAW Patrol",
    "Peg + Cat",
    "The Profit",
    "The Thundermans",
    "Total Divas",
    "Vanderpump Rules",
    "The Affair",
    "BoJack Horseman",
    "Bring It!",
    "Broad City",
    "CNN Tonight",
    "The Flash",
    "Henry Danger",
    "Hot Bench",
    "Inside Politics",
    "Judge Faith",
    "The Kitchen",
    "Late Night",
    "The Librarians",
    "Madam Secretary",
    "Mr. Pickles",
    "Odd Squad",
    "Playing House",
    "The Real",
    "Senora Acero",
    "Sonic Boom",
    "Southern Charm",
    "Squawk Alley",
    "Survivior's Remorse",
    "Z Nation",
    "Guiding Light",
    "It's Academic",
    "Sabado Gigante",
    "Washington Week",
    "NFL Films",
    "Masterpiece Theatre",
    "Great Performances",
    "Another World",
    "Soul Train",
    "This Week",
    "Firing Line",
    "American Bandstand",
    "Real Videos",
    "Captain Kangaroo",
    "ESPN SpeedWorld",
    "Inside Edition",
    "American Experience",
    "Camera Three",
    "The Jetsons",
    "E! News",
    "Investigative Reports",
    "Charlie Rose",
    "Hee Haw",
    "WWE Raw",
    "Reading Rainbow",
    "Modern Marvels",
    "Golf Talk",
    "Golf Central",
    "Sneak Previews",
    "Cookin' Cheap",
    "Private Screenings",
    "Antiques Roadshow",
    "Despierta America",
    "Computer Chronicles",
    "Divorce Court",
    "WWE SmackDown",
    "Showbiz Today",
    "MTV Unplugged",
    "Forensic Files",
    "Newton's Apple",
    "Ryan's Hope",
    "Hollywood Squares",
    "Knots Landing",
    "Speed Week",
    "Video Soul",
    "Illegal Knowledge",
    "American Idol",
    "NBA Shootaround",
    "Good Eats",
    "Howdy Doody",
    "PM Magazine",
    "Unsolved Mysteries",
    "Tim Russert",
    "Road Rules",
    "Star Search",
    "NYPD Blue",
    "Robot Chicken",
    "Love Connection",
    "Talk Soup",
    "Ricki Lake",
    "All That",
    "The Jeffersons",
    "Happy Days",
    "Intimate Portrait",
    "American Morning",
    "Blue's Clues",
    "Studio One",
    "Pantomime Quiz",
    "Getting Fit",
    "American Chopper",
    "Curious George",
    "The Boondocks",
    "The Challenge",
    "Reliable Sources",
    "Nashville Now",
    "Emeril Live",
    "Weather Center",
    "The Elizabeths",
    "Capital Gang",
    "Wild America",
    "The Jeffersons",
    "Murphy Brown",
    "CSI: Miami",
    "Hard Copy",
    "Perry Mason",
    "The Virginian",
    "Falcon Crest",
    "Family Matters",
    "The Waltons",
    "The Office",
    "Night Court",
    "Wagon Train",
    "Ford Theatre",
    "Home Improvement",
    "Full House",
    "Diff'rent Strokes",
    "Desperate Housewives",
    "The Practice",
    "Three's Company",
    "Barney Miller",
    "Perfect Strangers",
    "Fireside Theater",
    "Melrose Place",
    "Petticoat Junction",
    "Family Ties",
    "Mission: Impossible",
    "Medical Center",
    "Empty Nest",
    "Growing Pains",
    "Designing Women",
    "Cold Case",
    "Gilmore Girls",
    "Fantasy Island",
    "The Mentalist",
    "Bar Rescue",
    "Barnaby Jones",
    "Another Period",
    "Chicago Med",
    "Code Black",
    "Difficult People",
    "Documentary Now!",
    "THe Expanse",
    "Full Measure",
    "Game Shakers",
    "Good Witch",
    "Jessica Jones",
    "The Magicians",
    "Mr. Robot",
    "Schitt's Creek",
    "Teen Mom",
    "American Grit",
    "American Housewife",
    "Angie Tribeca",
    "Animal Kingdom",
    "Berlin Stations",
    "Better Things",
    "Channel Zero",
    "The Crown",
    "Designated Survivor",
    "The Detour",
    "Diesel Brothers",
    "The Exorcist",
    "Falling Water",
    "Fuller House",
    "High Maintenance",
    "Lady Dynamite",
    "Lethal Weapon",
    "Luke Cage",
    "Mighty Magiswords",
    "One Mississippi",
    "Paradise Run",
    "The Path",
    "The Ranch",
    "Total Bellas",
    "Van Helsing",
    "Wynonna Earp",
    "Silicon Valley",
    "Stranger Things",
    "Doctor Who",
    "Above Suspicion",
    "Absolutely Fabulous",
    "Absolute Power",
    "Ace Lightning",
    "After Dark",
    "After Henry",
    "Albion Market",
    "All Square",
    "'Allo 'Allo!",
    "Alphabet Castle",
    "Alphabet Zoo",
    "Andy Pandy",
    "Animal Kwackers",
    "Animal Magic",
    "Animal Mechanicals",
    "Animal Park",
    "Animal Stories",
    "The Angel",
    "Angelina Ballerina",
    "Anna Lee",
    "The Appleyards",
    "The Apprentice",
    "Armchair Theatre",
    "Art Attack",
    "As If",
    "The Avengers",
    "Baddiel's Syndrome",
    "Bad Education",
    "Bad Girls",
    "Bargain Hunt",
    "The Baron",
    "BBC News",
    "Beadle's About",
    "Beaver Falls",
    "Being Human",
    "Believe Nothing",
    "Big Kids",
    "Big Ticket",
    "Big Train",
    "The Bill",
    "Bizarre ER",
    "Black Arrow",
    "Black Books",
    "Black Mirror",
    "Blankety Blank",
    "Bleak House",
    "Blind Date",
    "The Block",
    "Blue Murder",
    "Blue Peter",
    "Bo' Selecta!",
    "The Borgias",
    "Brambly Hedge",
    "Brass Eye",
    "Brass Tacks",
    "Brat Camp",
    "Brat Farrar",
    "Breakfast News",
    "Brief Encounters",
    "Brit Cops",
    "Britain's Hardest",
    "Britannia High",
    "British Isles",
    "Brideshead Revisited",
    "Bromwell High",
    "The Brothers",
    "Brush Strokes",
    "The Bubble",
    "Burn It",
    "Burn Up",
    "Bus Life",
    "Button Moon",
    "Byker Grove",
    "The Café",
    "Café Continental",
    "California Dreaming",
    "Camberwick Green",
    "Candid Camera",
    "Cape Wrath",
    "Capital City",
    "Captain Pugwash",
    "Cardiac Arrest",
    "Case Histories",
    "Cash Cab",
    "Cats' Eyes",
    "Cause Célèbre",
    "Celebrity Juice",
    "Century Falls",
    "Chain Letters",
    "Challenge Anneka",
    "The Champions",
    "The Changes",
    "Changing Rooms",
    "Charlie Chalk",
    "The Chase",
    "Chewing Gum",
    "Child's Play",
    "Children's Emergency",
    "Children's Ward",
    "Chloe's Closet",
    "The Choir",
    "Chocky's Challenge",
    "Chocky's Children",
    "The Citadel",
    "Citizen Smith",
    "City Central",
    "City Hospital",
    "Clocking Off",
    "Coach Trip",
    "Cold Feet",
    "Come Dancing",
    "Come Outside",
    "Comedy Lab",
    "Comedy Playhouse",
    "The Commander",
    "Cone Zone",
    "The Cops",
    "Cop Squad",
    "Coronation Street",
    "Counterfeit Cat",
    "The Crezz",
    "Crime Traveller",
    "Criminal Justice",
    "Crocodile Shoes",
    "The Crouches",
    "The Crown",
    "Crown Court",
    "The Cube",
    "The Cup",
    "Dad's Army",
    "Danger Man",
    "Danger Mouse",
    "Danger UXB",
    "Dani's Castle",
    "Dani's House",
    "Daniel Deronda",
    "Dark Season",
    "DCI Banks",
    "Dead Gorgeous",
    "Dead Ringers",
    "Dead Set",
    "Dear John",
    "Deep Secrets",
    "Defying Gravity",
    "Delta Wave",
    "Department S",
    "Desperate Scousewives",
    "The Detectives",
    "Dial M",
    "Die Kinder",
    "Dirty Money",
    "Disney's CyberStar",
    "Disney Time",
    "Distant Shores",
    "Doc Martin",
    "Doctor, Doctor",
    "Doctor Finlay",
    "Doctor Who",
    "The Doctors",
    "The Door",
    "Double Dare",
    "Downton Abbey",
    "Dragons' Den",
    "Dream Stuffing",
    "Dream Team",
    "Duty Free",
    "Dying Day",
    "Echo Beach",
    "Eleventh Hour",
    "Elizabeth R",
    "Embarrassing Bodies",
    "Empire Road",
    "Engie Benjy",
    "Eternal Law",
    "Europe Today",
    "Europe Tonight",
    "Extraordinary People",
    "FAQ U",
    "The Face",
    "The Fades",
    "Fairy Tales",
    "Faking It",
    "The Fall",
    "Fame Academy",
    "The Family",
    "Family Affairs",
    "Family Catchphrase",
    "Family Fortunes",
    "Family Pride",
    "Family Tree",
    "The Farm",
    "Fat Families",
    "Father Brown",
    "Father Ted",
    "Fawlty Towers",
    "Fear Factor",
    "Fiddlers Three",
    "Fireman Sam",
    "First Class",
    "First Cut",
    "First Life",
    "The Five",
    "Five News",
    "The Fixer",
    "Flog It!",
    "Florrie's Dragons",
    "The Flumps",
    "Flying Squad",
    "Footballers' Wives",
    "Fort Boyard",
    "Forever Green",
    "The Fosters",
    "Four Weddings",
    "Foyle's War",
    "Fraggle Rock",
    "Free Agents",
    "Fresh Fields",
    "Fresh Meat",
    "Frozen Planet",
    "Full House",
    "Fun House",
    "Gadget Geeks",
    "The Games",
    "Games World",
    "The Garage",
    "Gardeners' World",
    "Garnock Way",
    "Garrow's Law",
    "Geordie Shore",
    "Getting On",
    "Gideon's Way",
    "Girl Friday",
    "Globe Trekker",
    "God's Gift",
    "Going Live!",
    "Going Straight",
    "Golden Balls",
    "The Goodies",
    "The Gophers",
    "The Governor",
    "The Grand",
    "Grange Hill",
    "Green Wing",
    "The Grid",
    "The Grimleys",
    "Hamish Macbeth",
    "Happy Families",
    "Happy Valley",
    "Harley Street",
    "Harry's Game",
    "Harry Hill",
    "Harry's Mad",
    "Harry Worth",
    "Hell's Kitchen",
    "Hello Cheeky",
    "Henry Hugglemonster",
    "The Herbs",
    "Hercule Poirot",
    "Here's Harry",
    "High Hopes",
    "High Living",
    "High Stakes",
    "The Hive",
    "Holby City",
    "Holiday Showdown",
    "Hollyoaks Later",
    "Hope Springs",
    "Horrid Henry",
    "Hot Property",
    "The Hotel",
    "Hotel Babylon",
    "The Hour",
    "House Doctor",
    "House Gift",
    "House Guest",
    "Howards' Way",
    "Human Remains",
    "The Hunger",
    "I, Claudius",
    "Ice Warriors",
    "The Inbetweeners",
    "Indian School",
    "Indian Summers",
    "Ink Thief",
    "Inside Gatwick",
    "Inspector Lewis",
    "Inspector Morse",
    "Inspector Wexford",
    "The Invisibles",
    "Jamaica Inn",
    "Jane Hall",
    "Jet Set",
    "Joking Apart",
    "Jonathan Creek",
    "Jonny Briggs",
    "Joshua Jones",
    "Jossy's Giants",
    "Jungle Run",
    "Juliet Bravo",
    "Junior MasterChef",
    "Junior Paramedics",
    "Kavanagh QC",
    "Keeping Mum",
    "Kick Start",
    "Killer Net",
    "The Kingdom",
    "King Rollo",
    "Kitchen Criminals",
    "The Knock",
    "Lab Rats",
    "The Lakes",
    "Land Girls",
    "Lavender Castle",
    "Lemur Street",
    "The Liars",
    "Life Begins",
    "Light Lunch",
    "The Likeaballs",
    "The Link",
    "Lip Service",
    "Liquid Television",
    "Little Britain",
    "Little Crackers",
    "Little Dorrit",
    "Little Einsteins",
    "Little Monsters",
    "Little Robots",
    "Little Women",
    "London Bridge",
    "London Ink",
    "London's Burning",
    "Loose Women",
    "The Losers",
    "Love Soup",
    "The Lovers",
    "Lucky Ladders",
    "Lucky Numbers",
    "Luton Airport",
    "Mad Dogs",
    "Magic Numbers",
    "Maisie Raine",
    "Making Out",
    "Making Waves",
    "Malice Aforethought",
    "The Mallens",
    "Man Alive",
    "The Match",
    "Material Girl",
    "Me Mammy",
    "Meerkat Manor",
    "Metal Mickey",
    "Micro Man",
    "Microscopic Milton",
    "Mida's Touch",
    "Midas Touch",
    "Midnight Man",
    "Midsomer Murders",
    "Mile High",
    "The Mill",
    "Millionaire Minor",
    "The Mint",
    "Miss Marple",
    "The Missing",
    "Mission Implausible",
    "Mister Maker",
    "The Mistress",
    "Mixed Blessings",
    "Molly's Gang",
    "The Monastery",
    "The Mole",
    "Monday Monday",
    "Monkey Dust",
    "Monkey Life",
    "Monkey Planet",
    "Monkey Trousers",
    "The Moomins",
    "Moone Boy",
    "Morning Exchange",
    "Morning Glory",
    "Mother Love",
    "Mount Pleasant",
    "Moving On",
    "Moving Wallpaper",
    "Mr. Bean",
    "Mr Moon",
    "Mr Selfridge",
    "Murder City",
    "Murder Rooms",
    "Murdoch Mysteries",
    "Murphy's Law",
    "The Musketeers",
    "My Hero",
    "Naked Jungle",
    "Nathan Barley",
    "The Nativity",
    "Natural World",
    "Nearly Famous",
    "Neighbours Revealed",
    "New Faces",
    "New Tricks",
    "The Newcomers",
    "Nick Kicks",
    "Night Fever",
    "Nighty Night",
    "Nini's Treehouse",
    "No Angels",
    "No Limits",
    "No Problem!",
    "Noah's Ark",
    "Noel's HQ",
    "The Noise",
    "Northern Lights",
    "The Octonauts",
    "Oh Boy!",
    "The Office",
    "Oh, Brother!",
    "Oliver's Travels",
    "Oliver's Twist",
    "On Safari",
    "Only Connect",
    "Orphan Black",
    "Opportunity Knocks",
    "Orange Playlist",
    "Oscar's Orchestra",
    "Outside Edge",
    "Painted Lady",
    "The Palace",
    "Parade's End",
    "The Paradise",
    "Park Avenue",
    "The Passion",
    "Paul Temple",
    "Peaky Blinders",
    "Peak Practice",
    "Pebble Mill",
    "Peep Show",
    "Penny Dreadful",
    "Peppa Pig",
    "Personal Affairs",
    "The Persuaders!",
    "Picture Page",
    "Pinwright's Progress",
    "The Pit",
    "Planet Earth",
    "Play Away",
    "Play School",
    "Plus One",
    "Pob's Programme",
    "Police Interceptors",
    "Police Stop!",
    "Police Surgeon",
    "Pop Idol",
    "Porno Valley",
    "Portland Bill",
    "Posh Pawn",
    "Postcode Challenge",
    "Postman Pat",
    "Pot Black",
    "The Practice",
    "Prank Patrol",
    "Praying Mantis",
    "Press Gang",
    "Prickly Heat",
    "Prime Suspect",
    "Princess Nikki",
    "Private Schulz",
    "Prize Island",
    "Project Catwalk",
    "The Prisoner",
    "The Professionals",
    "The Promise",
    "The Protectors",
    "Public Eye",
    "Puzzle Party",
    "Question Time",
    "Quiz Call",
    "The Race",
    "Ragdolly Anna",
    "Record Breakers",
    "Red Alert",
    "Red Dwarf",
    "The Regiment",
    "Remember Me",
    "Rescue Me",
    "The Restaurant",
    "Ripper Street",
    "Ripping Yarns",
    "Rising Damp",
    "The River",
    "River City",
    "Road Raja",
    "Road Wars",
    "Robin Hood",
    "Robin's Nest",
    "Robot Wars",
    "Rock Follies",
    "Rock School",
    "Rocket Man",
    "Rocky Hollow",
    "Roman Mysteries",
    "Rough Justice",
    "The Royal",
    "Rude Tube",
    "The Runaway",
    "Rush Hour",
    "The Saint",
    "Sam's Game",
    "The Sandbaggers",
    "Saturday Cookbook",
    "Saturday Kitchen",
    "The Savages",
    "The Scheme",
    "Scrapheap Challenge",
    "The Sculptress",
    "The Search",
    "Second Sight",
    "Secret Army",
    "Secret Fortune",
    "Secret Millionaire",
    "Sensitive Skin",
    "Sergeant Cork",
    "Sesame Tree",
    "Shillingbury Tales",
    "Shock Treatment",
    "Shoebox Zoo",
    "Shooting Stars",
    "Shrink Rap",
    "Silent Witness",
    "The Silence",
    "Sin Cities",
    "Single Father",
    "Sky Cops",
    "Slinger's Day",
    "Small Potatoes",
    "The Smoke",
    "Snuff Box",
    "Soldier Soldier",
    "Some Girls",
    "South Pacific",
    "Space Cadets",
    "Space Precinct",
    "Special Branch",
    "The Spies",
    "Spin Star",
    "Spitting Image",
    "Sports Review",
    "Star Cops",
    "Star Maidens",
    "Star Spell",
    "Star Stories",
    "Starhill Ponies",
    "Staying Alive",
    "Stella Street",
    "Stephen Brown",
    "Still Game",
    "Strange Report",
    "The Strangerers",
    "The Street",
    "Stressed Eric",
    "Strike Back",
    "Strictly Money",
    "Street Wars",
    "Strike Back",
    "Suburban Shootout",
    "Sugar Rush",
    "Sunday Brunch",
    "Sunday Feast",
    "Sutherland's Law",
    "The Sweeney",
    "Sweeney Todd",
    "Sweet Medicine",
    "The Syndicate",
    "The Take",
    "Takeover Bid",
    "The Taste",
    "Theatre Parade",
    "Thief Takers",
    "Thin Ice",
    "This Week",
    "Till Death...",
    "Time Trumpet",
    "Timmy Time",
    "Tiny Planets",
    "Tipping Point",
    "Torchwood Declassified",
    "Tomorrow's World",
    "Top Buzzer",
    "Top Gear",
    "Today's Business",
    "Total Wipeout",
    "Totally Senseless",
    "Tots TV",
    "Touching Evil",
    "Traffic Cops",
    "Treasure Hunt",
    "The Trip",
    "The Tripods",
    "Tripper's Day",
    "Tripping Over",
    "Trivial Pursuit",
    "True Love",
    "The Tube",
    "Tube Mice",
    "Tucker's Luck",
    "The Tudors",
    "The Tunnel",
    "Ultimate Force",
    "Undercover Boss",
    "University Challenge",
    "Up Pompeii!",
    "Upstairs, Downstairs",
    "The Valleys",
    "Velvet Soup",
    "The Venturers",
    "The Vice",
    "Victorian Pharmacy",
    "The Villa",
    "The Village",
    "Village Hall",
    "Vision On",
    "The Visit",
    "Vroom Vroom",
    "The Wall",
    "Waterloo Road",
    "Watership Down",
    "Weavers Green",
    "Weirdsister College",
    "White Teeth",
    "Whoops Apocalypse",
    "Wife Swap",
    "Wild Africa",
    "Wild Arabia",
    "Wild Brazil",
    "Wild Caribbean",
    "Wild China",
    "Winning Lines",
    "Wolf Hall",
    "The Wombles",
    "The Woodentops",
    "The Word",
    "World Business",
    "Worldwide Exchange",
    "Worzel Gummidge",
    "Wuthering Heights",
    "Yellowthread Street",
    "Yes Minister",
    "Young Apprentice",
    "Zero Hour",
    "Zoo Quest",
    "Zoo Time",
    "The Simpsons + C",
    "The Voi*e"
    ]

-- American Dad! / Candid Camera
