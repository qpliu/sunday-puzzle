2022-07-29 Riddler Classic
==========================
First, we need the probability of capture of one cup as a function of
its distance from the central point, $C(r)$, up to some constant
factor.

$$ C(r) = C_0\int_{-1}^1 dx \int_0^{\sqrt{1-x^2}} dy \space e^{-((x+r)^2 + y^2)/2} $$

$$  = C_0\int_{-1}^1 dx\space e^{-(x+r)^2/2} \int_0^{\sqrt{1-x^2}} dy\space e^{-y^2/2} $$

$$ = C_0\int_{-1}^1 dx\space e^{-(x+r)^2/2} \sqrt{\frac\pi2}\DeclareMathOperator\erf{erf}\erf(\sqrt{\frac{1-x^2}2}) $$

To get the actual probabilities, normalize to
$1/C_0 = \int_0^\infty e^{-r^2/2} r\space dr \int_0^{\pi} d\theta = \pi$.

For four cups, there are 4 reasonable placements to consider,

1. $C(0) + 3C(2) \approx 0.6391$
2. $2C(1) + 2C(\sqrt3) \approx 0.7779$
3. $4C(\sqrt2) \approx 0.7227$
4. $3C(2/\sqrt3) + C(\sqrt3+1/\sqrt3) \approx 0.7517$

where, using [code](20220729c.hs) to numerically calculate $C(r)$
since I don't know how to get a closed form expression for the
integral,
* $C(0) = 1-e^{-1/2} \approx 0.3935$
* $C(1) \approx 0.2671$
* $C(2/\sqrt3) \approx 0.2346$
* $C(\sqrt2) \approx 0.1807$
* $C(\sqrt3) \approx 0.1218$
* $C(2) \approx 0.08189$
* $C(\sqrt3 + 1/\sqrt3) = C(4/\sqrt3) \approx 0.04802$

The best is a 77.79% chance, which is two cups tangent to the central
point, and other two cups tangent to the first two cups.

Three of the placements can be hexagonally tiled circles, the first is
centered at the center of one of the cups.  The second and best is
centered at the intersection of two of the cups.  The fourth is
centered between three of the cups, with the fourth cup tangent to two
of the first three cups.

The third placement is a square tiling, centered at the center of the
four tiles.

Extra credit
------------
For other numbers of cups, I conjecture that hexagonal tiling is the
best and centered either in the middle of a cup, an intersection of
two cups, or the middle of three cups.

When using a hexagonal tiling, the centers of the cups are at
$(2i+j mod 2,j\sqrt 3)$, where $i$ and $j$ are integers.  The central
point could be at $(0,0)$ to be at the center of a cup, at $(1,0)$ to
be at the intersection of two cups, or at $(1,1/\sqrt3)$ to be at the
middle of three cups.

When the central point is at the center of a cup,

$$ r_{ij} = \sqrt{(2i+j\DeclareMathOperator\mod{mod}\mod2)^2 + 3j^2} $$

When the central point is at the intersection of two cups,

$$ r_{ij} = \sqrt{(2i+j\DeclareMathOperator\mod{mod}\mod2 - 1)^2 + 3j^2} $$

When the central point is at the center of three cups,

$$ r_{ij} = \sqrt{(2i+j\DeclareMathOperator\mod{mod}\mod2 - 1)^2 + (j\sqrt3 - 1/\sqrt3)^2} $$

$$ = \sqrt{(2i+j\DeclareMathOperator\mod{mod}\mod2 - 1)^2 + 3j^2 + 1/3
- 2j}

Using the [code](20220729c.hs),

|n |center|chance|
|--|------|------|
|1 |1 cup |$C(0) \approx 0.3935$|
|2 |2 cups|$2C(1) \approx 0.5342$|
|3 |3 cups|$3C(\sqrt{4/3}) \approx 0.7037$|
|4 |2 cups|$2C(1)+2C(\sqrt3) \approx 0.7779$|
|5 |2 cups|$2C(1)+2C(\sqrt3)+C(\sqrt7) \approx 0.8024$|
|6 |3 cups|$3C(\sqrt{4/3})+3C(\sqrt{16/3}) \approx 0.8478$|
|7 |1 cup |$C(0)+6C(2) \approx 0.8848$|
|8 |1 cup |$C(0)+6C(2)+C(\sqrt{12}) \approx 0.8879$|
|9 |1 cup |$C(0)+6C(2)+2C(\sqrt{12}) \approx 0.8911$|
|10|2 cups|$2C(1)+2C(\sqrt3)+4C(\sqrt7)+2C(3) \approx 0.8975$|
|11|2 cups|$2C(1)+2C(\sqrt3)+4C(\sqrt7)+2C(3)+C(\sqrt{13}) \approx 0.8996$|
|12|3 cups|$3C(\sqrt{4/3})+6C(28/3)+3C(\sqrt{16/3}) \approx 0.9044$|
|13|3 cups|$3C(\sqrt{4/3})+6C(28/3)+3C(\sqrt{16/3})+C(\sqrt{52/3}) \approx 0.9048$|
|14|2 cups|$2C(1)+2C(\sqrt3)+4C(\sqrt7)+2C(3)+4C(\sqrt{13}) \approx 0.9058$|
|15|2 cups|$2C(1)+2C(\sqrt3)+4C(\sqrt7)+2C(3)+4C(\sqrt{13})+C(\sqrt{19}) \approx 0.9059$|
|16|2 cups|$2C(1)+2C(\sqrt3)+4C(\sqrt7)+2C(3)+4C(\sqrt{13})+2C(\sqrt{19}) \approx 0.9061$|
|17|2 cups|$2C(1)+2C(\sqrt3)+4C(\sqrt7)+2C(3)+4C(\sqrt{13})+3C(\sqrt{19}) \approx 0.9063$|
|18|1 cup |$C(0)+6C(2)+6C(\sqrt{12})+5C(4) \approx 0.9066$|
|19|1 cup |$C(0)+6C(2)+6C(\sqrt{12})+6C(4) \approx 0.9072$|
|20|1 cup |$C(0)+6C(2)+6C(\sqrt{12})+6C(4)+C(\sqrt{28}) \approx 0.9072$|

Further thoughts
----------------
Since using a centered big cup of radius 4 would have a probability of
capture of $1 - e^{-8} \approx 0.9997$, I can estimate the probability
of capture when using an infinite hexagonal tiling.

When using a hexagonal tiling of a large number of cups, the
probability of capture appears to approach 90.67% when centered
between 3 cups, 90.68% when centered between 2 cups, and 90.72% when
centered on 1 cup, so when using 18 or more cups, the best probability
of capture is when centering on 1 cup.
