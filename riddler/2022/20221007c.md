2022-10-07 Riddler Classic
==========================
If there are $n$ pairs of socks in the basket and $m$ unpaired socks in
the backet, then there are $m$ socks on the chair.  The probability of
running out of room is

$$ f(n,m,c) = \frac{2nf(n-1,m+1,c) + mf(n,m-1,c)}{2n+m} $$

and

$$ f(0,m,c) = 0 $$

where $c$ is the number of spots on the chair, so

$$ f(n,c,c) = \frac{2n + cf(n,c-1,c)}{2n+c} $$

Using [code](20221007c.hs), $1-f(14,0,9) = 15627431/22309287 \approx 0.7005$.

Extra credit
------------
Tabulating up to 20 pairs,

|pairs|spots|1-f|1-f|
|-----|-----|---|---|
|1|1|1/1|1.0|
|2|1|1/3|0.3333333333333333|
|2|2|1/1|1.0|
|3|1|1/15|6.666666666666667e-2|
|3|2|3/5|0.6|
|3|3|1/1|1.0|
|4|1|1/105|9.523809523809525e-3|
|4|2|9/35|0.2571428571428571|
|4|3|27/35|0.7714285714285715|
|4|4|1/1|1.0|
|5|1|1/945|1.0582010582010583e-3|
|5|2|3/35|8.571428571428572e-2|
|5|3|7/15|0.4666666666666667|
|5|4|55/63|0.873015873015873|
|5|5|1/1|1.0|
|6|1|1/10395|9.62000962000962e-5|
|6|2|9/385|2.3376623376623377e-2|
|6|3|89/385|0.23116883116883116|
|6|4|445/693|0.6421356421356421|
|6|5|215/231|0.9307359307359307|
|6|6|1/1|1.0|
|7|1|1/135135|7.4000074000074e-6|
|7|2|27/5005|5.394605394605395e-3|
|7|3|97/1001|9.69030969030969e-2|
|7|4|3625/9009|0.40237540237540237|
|7|5|2315/3003|0.7708957708957709|
|7|6|413/429|0.9627039627039627|
|7|7|1/1|1.0|
|8|1|1/2027025|4.9333382666716e-7|
|8|2|27/25025|1.078921078921079e-3|
|8|3|881/25025|3.5204795204795206e-2|
|8|4|65/297|0.21885521885521886|
|8|5|1691/3003|0.5631035631035631|
|8|6|1841/2145|0.8582750582750582|
|8|7|6307/6435|0.9801087801087801|
|8|8|1/1|1.0|
|9|1|1/34459425|2.901963686277412e-8|
|9|2|81/425425|1.9039783745666098e-4|
|9|3|4801/425425|1.1285185402832461e-2|
|9|4|48275/459459|0.10506922271628154|
|9|5|18635/51051|0.3650271297330121|
|9|6|25361/36465|0.6954888249005896|
|9|7|100051/109395|0.9145847616435852|
|9|8|12027/12155|0.9894693541752365|
|9|9|1/1|1.0|
|10|1|1/654729075|1.5273493085670588e-9|
|10|2|243/8083075|3.006281644052542e-5|
|10|3|81/25025|3.2367632367632368e-3|
|10|4|394025/8729721|4.513603584811015e-2|
|10|5|205745/969969|0.21211502635651241|
|10|6|353731/692835|0.5105559043639539|
|10|7|1653673/2078505|0.7956069386409944|
|10|8|16869/17765|0.9495637489445539|
|10|9|45933/46189|0.9944575548290718|
|10|10|1/1|1.0|
|11|1|1/13749310575|7.273091945557423e-11|
|11|2|243/56581525|4.294688062932203e-6|
|11|3|1901/2263261|8.399384781516582e-4|
|11|4|292375/16665831|1.7543379625054402e-2|
|11|5|757655/6789783|0.11158751317972901|
|11|6|236131/692835|0.3408185210042795|
|11|7|3985147/6235515|0.6391047090737493|
|11|8|1401447/1616615|0.8669021381095684|
|11|9|313851/323323|0.970704218382237|
|11|10|87923/88179|0.9970968144342758|
|11|11|1/1|1.0|
|12|1|1/316234143225|3.1622138893727926e-12|
|12|2|729/1301375075|5.601767038607221e-7|
|12|3|258987/1301375075|1.9901026612177892e-4|
|12|4|197375/31702671|6.225816114989176e-3|
|12|5|108725/2028117|5.360884012115672e-2|
|12|6|3316901/15935205|0.20814925192364955|
|12|7|67882381/143416845|0.47332223073238017|
|12|8|5529357/7436429|0.7435500291873962|
|12|9|6807693/7436429|0.9154518922993818|
|12|10|14993/15249|0.983212013902551|
|12|11|675015/676039|0.9984852944874482|
|12|12|1/1|1.0|
|13|1|1/7905853580625|1.264885555749117e-13|
|13|2|2187/32534376875|6.722120446328664e-8|
|13|3|28803/663966875|4.338017615713133e-5|
|13|4|8570675/4216455243|2.032673064472512e-3|
|13|5|3700465/156165009|2.369586518577923e-2|
|13|6|46629821/398380125|0.11704856260085766|
|13|7|1161545413/3585421125|0.3239634543627006|
|13|8|553853529/929553625|0.5958274101722749|
|13|9|6122637/7436429|0.8233302570360048|
|13|10|9607081/10140585|0.9473892285307012|
|13|11|16740207/16900975|0.9904876493811747|
|13|12|1299051/1300075|0.9992123531334731|
|13|13|1/1|1.0|
|14|1|1/213458046676875|4.684761317589322e-15|
|14|2|243/32534376875|7.46902271814296e-9|
|14|3|854569/97603130625|8.755549074376835e-6|
|14|4|3041575/4949751807|6.144904065085783e-4|
|14|5|504843/52055003|9.69826089530722e-3|
|14|6|72860599/1195140375|6.096405118938434e-2|
|14|7|19916928199/96806370375|0.20573985081609356|
|14|8|414258777/929553625|0.4456534468358402|
|14|9|15627431/22309287|0.7004899349764069|
|14|10|48266999/54759159|0.881441568523724|
|14|11|16357231/16900975|0.9678276549134|
|14|12|11638211/11700675|0.9946615045713174|
|14|13|5012527/5014575|0.9995915905136527|
|14|14|1/1|1.0|
|15|1|1/6190283353629375|1.6154349370997664e-16|
|15|2|729/943496929375|7.726575225665133e-10|
|15|3|32117/19520626125|1.6452853404567728e-6|
|15|4|571002125/3301484455269|1.7295314660310148e-4|
|15|5|150628805/40759067349|3.6955900808583048e-3|
|15|6|44554573/1506916125|2.9566723894470237e-2|
|15|7|341841612427/2807384740875|0.12176514584903511|
|15|8|494147013/1585709125|0.3116252566182338|
|15|9|605718237/1078282205|0.5617437014088533|
|15|10|1246054139/1588015611|0.7846611395812028|
|15|11|193712959/210054975|0.922201242793702|
|15|12|110914141/113106525|0.9806166443536304|
|15|13|144990547/145422675|0.99702846890968|
|15|14|9692797/9694845|0.9997887537139583|
|15|15|1/1|1.0|
|16|1|1/191898783962510625|5.211080442257311e-18|
|16|2|2187/29248404810625|7.477330863546902e-11|
|16|3|8459361/29248404810625|2.8922469634743934e-7|
|16|4|95115875/2088694247211|4.5538438728888495e-5|
|16|5|97914715/74325358107|1.3173796601025503e-3|
|16|6|43240531327/3223293591375|1.3415014829150066e-2|
|16|7|5869731649621/87028926967125|6.744575458040841e-2|
|16|8|34141402959/167133741775|0.20427594450055506|
|16|9|1289453097/3038795305|0.4243303571248607|
|16|10|163593657337/246142419705|0.6646300850258394|
|16|11|38707706983/45581929575|0.8491897412835665|
|16|12|3330724163/3506302275|0.9499249927047434|
|16|13|4456128781/4508102925|0.9884709500060938|
|16|14|300046627/300540195|0.9983577304859338|
|16|15|300507427/300540195|0.9998909696588172|
|16|16|1/1|1.0|
|17|1|1/6332659870762850625|1.5791152855325184e-19|
|17|2|2187/321732452916875|6.7975735123153655e-12|
|17|3|1487071/31135398669375|4.776142473045298e-8|
|17|4|3846875/341532874683|1.126355699600089e-5|
|17|5|6131472505/13898841966009|4.411498828460044e-4|
|17|6|202734788389/35456229505125|5.717889104922897e-3|
|17|7|100808895154933/2871954589915125|3.510114523012434e-2|
|17|8|1157548337529/9192355797625|0.12592510157494907|
|17|9|111137050977/367694231905|0.30225399621094445|
|17|10|394530697451/738427259115|0.5342851209526613|
|17|11|34217131111/45581929575|0.7506731599569412|
|17|12|34587984353/38569325025|0.896774427101865|
|17|13|28810494089/29753479305|0.9683067245234229|
|17|14|3283524737/3305942145|0.9932190561671187|
|17|15|3302960257/3305942145|0.9990980217229422|
|17|16|583368787/583401555|0.9999438328545421|
|17|17|1/1|1.0|
|18|1|1/221643095476699771875|4.5117579586643385e-21|
|18|2|6561/11260635852090625|5.826491581984599e-13|
|18|3|83739041/11260635852090625|7.43643983340898e-9|
|18|4|62101460125/23641930184181309|2.62675084653417e-6|
|18|5|13551395855/97291893762063|1.392859706086232e-4|
|18|6|407373036217/177281147525625|2.297892595478132e-3|
|18|7|247355373953737/14359772949575625|1.722557695183106e-2|
|18|8|760012078869/10378466223125|7.322971068456753e-2|
|18|9|523573987239/2573859623335|0.20341979123189127|
|18|10|2105961162349/5168990813805|0.40742211356316166|
|18|11|337401280007/531789178375|0.6344643586731203|
|18|12|1141417771/1393112875|0.8193289944291126|
|18|13|22333162111/23994741375|0.930752357859077|
|18|14|3240598657/3305942145|0.9802345337171652|
|18|15|23050205063/23141595015|0.996050836083651|
|18|16|20408994649/20419054425|0.9995073338955558|
|18|17|2268718289/2268783825|0.9999711140394788|
|18|18|1/1|1.0|
|19|1|1/8200794532637891559375|1.2193940428822536e-22|
|19|2|19683/416643526527353125|4.724182363771297e-14|
|19|3|91267009/83328705305470625|1.0952649349996348e-9|
|19|4|506889360625/874751416814708433|5.794667500748619e-7|
|19|5|13613839585/327254551745121|4.1600153496422585e-5|
|19|6|5730014591357/6559402458448125|8.735574052141103e-4|
|19|7|4248739890847501/531311599134298125|7.996700801883978e-3|
|19|8|12964081010571/321732452916875|4.0294601595321465e-2|
|19|9|649844068017/5012252950705|0.1296510919157813|
|19|10|56406663703489/191252660110785|0.29493270143701467|
|19|11|84612674773/165346215125|0.5117303393309227|
|19|12|1714471004467/2378441709875|0.7208379323944436|
|19|13|23999843315461/27521968357125|0.8720249585363622|
|19|14|3155074177/3305942145|0.9543646073092426|
|19|15|36774831221/37227783285|0.9878329563559455|
|19|16|753782498269/755505013725|0.9977200476175437|
|19|17|11988931811/11992143075|0.9997322193389525|
|19|18|4418092439/4418157975|0.9999851666689216|
|19|19|1/1|1.0|
|20|1|1/319830986772877770815625|3.1266513920057783e-24|
|20|2|19683/5416365844855590625|3.633986433670228e-15|
|20|3|828931049/5416365844855590625|1.5304192381822036e-10|
|20|4|94523125/779404291786197|1.2127611561308824e-7|
|20|5|14908694915/1264794618906819|1.1787443346245265e-5|
|20|6|26865719813849/85272231959825625|3.1505824576640924e-4|
|20|7|72980576147996923/20721152366237626875|3.5220326967388698e-3|
|20|8|651138170767983/30950661970603375|2.103794004103781e-2|
|20|9|97117204525767/1238026478824135|7.84451755975429e-2|
|20|10|216275716961953/1065550534902945|0.2029708679951555|
|20|11|100705922681639/255790594798375|0.3937045564987238|
|20|12|30408736301359/49947275907375|0.6088167122016954|
|20|13|65391963294991/82565905071375|0.7919971716952924|
|20|14|62995937351/69137311815|0.9111713443468369|
|20|15|10801592947879/11131107202215|0.9703969921096053|
|20|16|29246559712939/29464695535275|0.9925967053664325|
|20|17|1089859742897/1091285019825|0.998693946217434|
|20|18|57427730603/57436053675|0.9998550897656183|
|20|19|34461370061/34461632205|0.9999923931635495|
|20|20|1/1|1.0|

If $c \ge n$, then $1-f = 1$.

If $c = 1$, then
$1-f(n,0,1) = \frac{1-f(n-1,0,1)}{2n-1} = \prod_{i=1}^n\frac1{2i-1}$.

The probabilities for other values of $c$ would fall in between, and
will require more thought.

Further thoughts
----------------
Let $S = 1-f$,

$$ S(n,0,c) = 1, c \ge n $$

$$ S(n,0,1) = \prod_{i=1}^n\frac1{2i-1} $$

* $S(2,0,2) = 1$
* $S(3,0,2) = 4S(1,2,2)/5 + S(2,0,2)/5 = 4S(1,2,2)/5 + 1/5 = 3/5$
** $S(1,2,2) = S(1,1,2)/2 = 1/2$
* $S(4,0,2) = 6S(2,2,2)/7 + S(3,0,2)/7 = 6S(2,2,2)/7 + 3/35 = 9/35$
** $S(2,2,2) = 2S(2,1,2)/6 = 1/3 (4S(1,2,2)/5 + S(2,0,2)/5) = 1/3 (2/5 + 1/5) = 1/5$

It looks like $S(n,0,2) = \prod_{i=2}^n\frac3{2i-1}$.

Continuing,
* $S(4,0,3) = S(3,1,3) = 6/7 S(2,2,3) + 1/7 S(3,0,3) = 6/7 S(2,2,3) + 1/7 = 27/35$
** $S(2,2,3) = 4/6 S(1,3,3) + 2/6 S(2,1,3) = 2/3 S(2,3,3) + 1/3 = 11/15$
*** $S(1,3,3) = 3/5 S(1,2,3) = 3/5$
* $S(5,0,3) = S(4,1,3) = 8/9 S(3,2,3) + 1/9 S(4,0,3) = 8/9 S(3,2,3) + 1/9 27/35 = 7/15$
** $S(3,2,3) = 6/8 S(2,3,3) + 2/8 S(3,1,3) = 3/4 11/35 + 1/4 27/35 = 3/7$
*** $S(2,3,3) = 3/7 S(2,2,3) = 11/35$
*** $S(3,1,3) = 6/7 S(2,2,3) + 1/7 S(3,0,3) = 6/7 11/15 + 1/7 = 27/35
* $S(6,0,3) = S(5,1,3) = 10/11 S(4,2,3) + 1/11 S(5,0,3) = 10/11 109/525 + 1/11 7/15 = 89/385$
** $S(4,2,3) = 8/10 S(3,3,3) + 2/10 S(4,1,3) = 4/5 1/7 + 1/5 7/15 = 109/525$
*** $S(3,3,3) = 3/9 S(3,2,3) = 1/7$
**** $S(4,1,3) = 8/9 S(3,2,3) + 1/9 S(4,0,3) = 8/9 3/7 + 1/9 27/35 = 7/15$

Not seeing the pattern for $S(n,0,3)$.
