2023-02-03 Riddler Classic
==========================
At verse $n$, the chance of starting over is $p$, then the number of
verses from that verse is

$$ V(n) = 1 + pV(99) + (1-p)V(n-1) $$

and $V(1) = 1$, so

$$ V(2) = 1 + pV(99) + (1-p) $$

$$ V(3) = 1 + pV(99) + (1-p)V(2) = (1 + pV(99))(1+(1-p)) + (1-p)^2 $$

$$ V(4) = 1 + pV(99) + (1-p)V(3) = (1 + pV(99))(1+(1-p)(1+(1-p))) + (1-p)^3 $$

Let $P(i,p) = 1 + (1-p)P(i-1,p)$, where $P(2) = 1$.  Then

$$ V(n) = (1 + pV(99))P(n) + (1-p)^{n-1} $$

and

$$ V(99) = \frac{P(99) + (1-p)^{98}}{1 - pP(99)} $$.

Using [code](20230203c.hs), $V(99) = 630270362350273227342812094371194559404331235718258897569740027576447429544722476578589349989871767272059021110451673459880570003230505640548378429806355985581928939332340698615000220000840799500101/3734642804542694673304928339684903440360290548300415176063232044682349196517954782034451010203315482100413928177255823637569999967368629893450722931248929438566374350178376781666664444435951520201 \approx 168.76$.

Extra credit
------------
We have

$$ V(n) = 1 + V(N)/N + (1-1/N) V(n-1) $$

Let $s = 1-1/N$, and since $K = V(N)$

$$ V(n) = 1 + K/N + sV(n-1) $$

Since $V(1) = 1$,

$$ V(2) = 1+K/N + s $$

$$ V(3) = 1+K/N + sV(2) = (1+K/N)(1+s) + s^2 $$

$$ V(4) = 1+K/N + sV(3) = (1+K/N)(1+s+s^2) + s^3 $$

$$ V(n) = K/N (1+s+s^2+\ldots+s^{n-2}) + (1+s+s^2+\ldots+s^{n-1}) $$

$$ V(N) = K = K/N (1+s+s^2+\ldots+s^{N-2}) + (1+s+s^2+\ldots+s^{N-1}) $$

Let $S(n) = \sum^{n-1}_{i=0} s^i$,

$$ K/N = \frac{S(N-1)/N}{1 - S(N)/N} $$

To evaluate $S(N)$,

$$ sS(N) = s^N + S(N) - 1 $$

$$ S(N) = \frac{s^N - 1}{s - 1} $$

$$ S(N) = \frac{(1-1/N)^N - 1}{1-1/N-1} = N(1-(1-1/N)^N) $$

$$ S(N)/N = 1 - (1-1/N)^N $$

So $S(N)/N$ approaches $1 - 1/e$ for large $N$.

And $K/N$ approaches $(1-1/e)/(1-(1-1/e)) = e-1$ for large $N$.
