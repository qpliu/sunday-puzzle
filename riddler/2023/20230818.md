2023-08-18 Fiddler
==================
If there are $n < 3$ runners on base and $m < 3$ outs and the slugger is due up
after $p > 0$ at-bats, the average number of runs scored is

$$ R(n,m,p) = R(n+1,m,p-1)/3 + 2R(n,m+1,p-1)/3 $$

If there are 3 runners on base and $m > 3$ outs and the slugger is due up
after $p > 0$ at bats, the average number of runs scored is

$$ R(3,m,p) = (1+R(3,m,p-1))/3 + 2R(3,m+1,p-1)/3 $$

If there are $n \le 3$ runners on base and $m < 3$ outs and the slugger is up,
the average number of runs scored is

$$ R(n,m,0) = (1+n+R(0,m,8))/10 + 9R(n,m+1,8)/10 $$

Also,

$$ R(n,3,p) = 0 $$

Instead of the inverting the matrix, I'll use [code](20230818.hs) and add a
special case of the slugger batting with 3 on to avoid the infinite loop
of batting through the lineup without any outs,

$$ R(3,m,0) = 9R(3,m+1,8)/10 + \frac{1}{10}(4 + 2R(0,m+1,8)/3
   + \frac{1}{3}(2R(1,m+1,7)/3
   + \frac{1}{3}(2R(2,m+1,6)/3
   + \frac{1}{3}(2R(3,m+1,5)/3
   + \frac{1}{3}(1 + 2R(3,m+1,4)/3
   + \frac{1}{3}(1 + 2R(3,m+1,3)/3
   + \frac{1}{3}(1 + 2R(3,m+1,2)/3
   + \frac{1}{3}(1 + 2R(3,m+1,1)/3
   + \frac{1}{3}R(3,m,0))))))))) $$

or

$$ R(3,m,0) = 9R(3,m+1,8)/10 + \frac{1}{10}(4 + 2R(0,m+1,8)/3
   + \frac{1}{3}(2R(1,m+1,7)/3
   + \frac{1}{3}(2R(2,m+1,6)/3
   + \frac{1}{3}(2R(3,m+1,5)/3
   + \frac{1}{3}(1 + 2R(3,m+1,4)/3
   + \frac{1}{3}(1 + 2R(3,m+1,3)/3
   + \frac{1}{3}(1 + 2R(3,m+1,2)/3
   + \frac{1}{3}(1 + 2R(3,m+1,1)/3))))))))
   + \frac{1}{10}\frac{1}{3^8}R(3,m,0) $$

Solving for $R(0,0,p)$ for the different values of $p$ gives

|slugger slot|average runs|
|------------|------------|
|1|30705914956035111881/166764191515406259210 or approximately 0.18412774755183814|
|2|105427777956070711373/500292574546218777630 or approximately 0.21073224612957137|
|3|359265737504488261637/1500877723638656332890 or approximately 0.23937042428313318|
|4|60071937158948365151/250146287273109388815 or approximately 0.2401472267040362|
|5|10142292288127550275/50029257454621877763 or approximately 0.2027272201136891|
|6|96496593331716392/617645153760763923 or approximately 0.1562330615631981|
|7|311913520655760143/1852935461282291769 or approximately 0.16833480019854863|
|8|968596836828171410/5558806383846875307 or approximately 0.17424547104982469|
|9|2951075404024859021/16676419151540625921 or approximately 0.17696097568717134|

Putting the slugger 4th maximizes the average runs scored in the
first inning at approximately 0.240 runs.

Putting the slugger 6th minimizes the average runs scored in the
first inning at approximately 0.156 runs.

Extra credit
------------
For a given inning with the sluggers due up after $p$ and $q > p$ batters,
the next inning will start with the sluggers due up of after $p'$ and $q' > p'$
batters with probability $P(p,q,p',q')$ and scoring $R(p,q,p',q')$ runs
on average.

The total average score for sluggers due up after $p$ and $q$ batters in
the $n$th inning is

$$ S(n,p,q) = \sum_{p',q'} P(p,q,p',q')(R(p,q,p',q') + S(n+1,p',q')) $$

where $S(10,p,q) = 0$.

|sluggers|average runs|
|--------|------------|
|1,2|70521089223465571389091957287761130285900275513357418140506154787936193270801328179026935357589378004816323947195600563721511712432197306853603211711/36430891491706496497522775529862499364322596725610701211199132773059349826699831529921728852326169944256131349127049816283181078189670276101072045700 or approximately 1.935749753461831|
|1,3|130323329184573110143598470283669404436598347544016660441741847632236369188664022874891499188645512065964025166881750904577795007277684470662722235017950763395735126650692377455266710106610204646454431/66554168929859243521026535164314938144695289091870008189609858366669713663225278878679248944792544789902937221351510129634207759922350160480274555835904154577813061780255286253424493655654907226562500 or approximately 1.958154256601409|
|1,4|129279642863569328375091265167594592102801230143453251446302868449638188800005809244255734388159454631452269715420507331430176838137542725955566324143654824035502692620240431558186076540936085373874389/66554168929859243521026535164314938144695289091870008189609858366669713663225278878679248944792544789902937221351510129634207759922350160480274555835904154577813061780255286253424493655654907226562500 or approximately 1.9424724993533586|
|1,5|129152609094962747478781000520144127058308073164022338077533369472440631305939251085325022195603367811324225830656359767299840756174025715343361593607791798796387247529158373384685867794134277013178669/66554168929859243521026535164314938144695289091870008189609858366669713663225278878679248944792544789902937221351510129634207759922350160480274555835904154577813061780255286253424493655654907226562500 or approximately 1.940563771911499|
|1,6|236988892463586568026466162774851433507602401148438715452024786441314467451984878814632935596251483798764176993486204751929462694408669749175137833093889899726237702580768582655119839473236634356263/123248460981220821335234324378360996564250535355314829980758996975314284561528294219776386934801008870190624483984278017841125481337685482370878807103526212181135299593065344913749062325286865234375 or approximately 1.9228547811213335|
|1,7|1417091906498044673265145771112001376221228386201218224523960660565431355731638277739255195955522935915073642262488009543918508708148964938401348554266004338673666096515242730067337614931382635611557/739490765887324928011405946270165979385503212131888979884553981851885707369169765318658321608806053221143746903905668107046752888026112894225272842621157273086811797558392069482494373951721191406250 or approximately 1.9163077780932896|
|1,8|425138449116042940179036291246462573614208526062236603704028902461965111831908681978189364885617145174096100670270787712942500071443163648955028010662113248353053017306753526953038987194462627893388/221847229766197478403421783881049793815650963639566693965366194555565712210750929595597496482641815966343124071171700432114025866407833868267581852786347181926043539267517620844748312185516357421875 or approximately 1.9163568080795599|
|1,9|691605641131574729903052944790856950710693190527689507978807453333157681320871711801954912082930620464610792475067044223931204433461445446663385488/364308914917064964975227755298624993643225967256107012111991327730593498266998315299217288523261699442561313491270498162831810781896702761010720457 or approximately 1.8984043837879152|
|2,3|11919169222113884131812835607640616866391745394336176652379733149745787926312278201206119929398160450267909309046072783665130506543343642506784681/5996854566536048806176588564586419648448164070059374684971050662231991741020548399987115860465213159548334378457127541775009230977723502238859596 or approximately 1.9875701653039637|
|2,4|394271115785162843507023505151016065960788638707231097515109192922709697451363743318700612076012990748121444888157234030315600716910179172432905583869066790307430405801864172170435230352841533046589889/199662506789577730563079605492944814434085867275610024568829575100009140989675836636037746834377634369708811664054530388902623279767050481440823667507712463733439185340765858760273480966964721679687500 or approximately 1.9746877975476944|
|2,5|387910940553390624248671640959230006381324590060601227872887532382760667793461712339496709321420683607199506861355555161593388261458837692177280405059416775010421965749414610723783612145760788890192941/199662506789577730563079605492944814434085867275610024568829575100009140989675836636037746834377634369708811664054530388902623279767050481440823667507712463733439185340765858760273480966964721679687500 or approximately 1.9428331677825021|
|2,6|388630826883488329332543686335374847916452862142387894131209853274988125890334471043324266744074949600101973383037085557412729610364664006180636973937188965942184457286330953437465660139076047280463507/199662506789577730563079605492944814434085867275610024568829575100009140989675836636037746834377634369708811664054530388902623279767050481440823667507712463733439185340765858760273480966964721679687500 or approximately 1.9464386836185643|
|2,7|725202004562264358234873003820795907156552078754802900023636017085811426796450530270120927031415619866172508548429176091906491736899266718672199650699190637036810987781527261085221211279508402939837/369745382943662464005702973135082989692751606065944489942276990925942853684584882659329160804403026610571873451952834053523376444013056447112636421310578636543405898779196034741247186975860595703125 or approximately 1.9613551325203762|
|2,8|859580655769844444200067396926274206423230566901767281330680100405709690800225545254367495650470389404764331143114159757244055309820016491796687540041297496049010542730771085514424543239874888745019/443694459532394956806843567762099587631301927279133387930732389111131424421501859191194992965283631932686248142343400864228051732815667736535163705572694363852087078535035241689496624371032714843750 or approximately 1.9373256467429134|
|2,9|6397142555140740671372356597139300326153843868014990664031708506828392751218860410402721604639076502153760844436208011187330951831019493577378541278073254088110615076803879291674678562441412510404528/3327708446492962176051326758215746907234764454593500409480492918333485683161263943933962447239627239495146861067575506481710387996117508024013727791795207728890653089012764312671224682782745361328125 or approximately 1.922386728886247|
|3,4|72778448623911896780029713451595396724137794193477464659223436950187919927075169373796852257191527529986660810552685049903429149102548345261001629593/36430891491706496497522775529862499364322596725610701211199132773059349826699831529921728852326169944256131349127049816283181078189670276101072045700 or approximately 1.9977125358153789|
|3,5|1179160383103529728890656217154295360486348800502519054097043846120257198420608192692018654787020213113634623200833943824519672462450224027700286138006485905226810878077828596040413577042868682113403121/598987520368733191689238816478834443302257601826830073706488725300027422969027509908113240503132903109126434992163591166707869839301151444322471002523137391200317556022297576280820442900894165039062500 or approximately 1.9685892326732375|
|3,6|1166788646505159441683614956612361692697945193315594745268997036725593700903462616167173274502960718551271997588913140978894004094129881587451641917306872662429645236779876134208636123978536393021802999/598987520368733191689238816478834443302257601826830073706488725300027422969027509908113240503132903109126434992163591166707869839301151444322471002523137391200317556022297576280820442900894165039062500 or approximately 1.947934818052455|
|3,7|1188255968637757693051245100133913877937447714693633112652910070237437130499207594052326900807140986040828953935894707880127548649253068817408742958424083872277817271300524525883008324162495510927679247/598987520368733191689238816478834443302257601826830073706488725300027422969027509908113240503132903109126434992163591166707869839301151444322471002523137391200317556022297576280820442900894165039062500 or approximately 1.9837741659563697|
|3,8|2195609427966809175736778111180582759492520293787820845145866564079444736978164585786082854508058657135787378286761805041229869090208668440513097262272849547149581033700627731708077795665914861355537/1109236148830987392017108919405248969078254818197833469826830972777828561053754647977987482413209079831715620355858502160570129332039169341337909263931735909630217696337588104223741560927581787109375 or approximately 1.9793886362978157|
|3,9|12926883126544820909954444186960543098984539626647694923009403039987252696115615840419419981470149979890732032439764376972858338346416821325282230775877425375031728470930212084564076284338154380504889/6655416892985924352102653516431493814469528909187000818960985836666971366322527887867924894479254478990293722135151012963420775992235016048027455583590415457781306178025528625342449365565490722656250 or approximately 1.9423100512558922|
|4,5|53714885838530617518699470800395108707683886025401988283820297280181369222886568018288823644258530431907085925451867611456887438717999182450893665062/27323168618779872373142081647396874523241947544208025908399349579794512370024873647441296639244627458192098511845287362212385808642252707075804034275 or approximately 1.9659098323468633|
|4,6|97279468954227877333604215379241864584203724654407086763748444274289764024613214177247915679886229764171972865011093436794488867200555866751852614965806475484550071330689575701880250522133534695803136/49915626697394432640769901373236203608521466818902506142207393775002285247418959159009436708594408592427202916013632597225655819941762620360205916876928115933359796335191464690068370241741180419921875 or approximately 1.9488780446245666|
|4,7|97855718177650581243425144765395847760302620677764468453606201771633640265827334208241669569085389890878285155766772487384565363471445569867096298926786696325516379658136438865126001692461743523712284/49915626697394432640769901373236203608521466818902506142207393775002285247418959159009436708594408592427202916013632597225655819941762620360205916876928115933359796335191464690068370241741180419921875 or approximately 1.9604225099864085|
|4,8|98836933570640167489186853438784760530451652628179249970970601567115465460835337543379468772447444161435889089561662895899208763886476078796957491355439692027221547787256888006553359718885209693790853/49915626697394432640769901373236203608521466818902506142207393775002285247418959159009436708594408592427202916013632597225655819941762620360205916876928115933359796335191464690068370241741180419921875 or approximately 1.9800799891750012|
|4,9|6542296825671058160909085901486829876019695715765219287715171262660595615606199292694921898546609411283354978699673751836447421056337381330975433515369145752666469838302836188082252414981736176604813/3327708446492962176051326758215746907234764454593500409480492918333485683161263943933962447239627239495146861067575506481710387996117508024013727791795207728890653089012764312671224682782745361328125 or approximately 1.9660066171259438|
|5,6|471941878556951250217313504116986998218910089760555626872754792755981374085110334393169059018628195322565510221554994745517831589483952424125374885392/245908517569018851358278734826571870709177527897872233175594146218150611330223862826971669753201647123728886606607586259911472277780274363682236308475 or approximately 1.9191766239837214|
|5,7|96549654445168501069677841722270788583139678894603665755630981336214911343520349900820100825357316926478374795756030564514087437760047215159155785988180236699849597341674935859776838231139439419812968/49915626697394432640769901373236203608521466818902506142207393775002285247418959159009436708594408592427202916013632597225655819941762620360205916876928115933359796335191464690068370241741180419921875 or approximately 1.9342570820654112|
|5,8|96278635491268374160714702684432962054927768254264006506884381564955750913692937615048366556492061317065516166220376956101003097750422682632425253515995650237727912372193057257377123396972567840734242/49915626697394432640769901373236203608521466818902506142207393775002285247418959159009436708594408592427202916013632597225655819941762620360205916876928115933359796335191464690068370241741180419921875 or approximately 1.9288275408208801|
|5,9|47769927774011781765521874122346603596897998388884351842499206528113831358149684995118293168527689939357926600828369806696167260594566419092300428589964215393075024029139030121940792354100619098238/24649692196244164267046864875672199312850107071062965996151799395062856912305658843955277386960201774038124896796855603568225096267537096474175761420705242436227059918613068982749812465057373046875 or approximately 1.9379523035703632|
|6,7|77052292433060578072588257233462470537842003387864369618779968586134681071771127964617705174563593235795164102741002939524587132154782544988346455/40478768324118329441691972810958332627025107472900779123554591970065944251888701699913032058140188826951257054585610906981312309099633640112302273 or approximately 1.9035236402474915|
|6,8|28118832801127429326459183647482297336778902863209354394214484279003476699882688369253719683486522533183197036207539782078006706894560415936967260771739174141186856068977953654518922345388974211231/14789815317746498560228118925403319587710064242637779597691079637037714147383395306373166432176121064422874938078113362140935057760522257884505456852423145461736235951167841389649887479034423828125 or approximately 1.9012294742712077|
|6,9|27900564361951567003714151469210139131448604260930859629170255451037904639622299338915843227019219545774233979947385937076671962883238447192511614727416928405895630837048039531080738334357853267889/14789815317746498560228118925403319587710064242637779597691079637037714147383395306373166432176121064422874938078113362140935057760522257884505456852423145461736235951167841389649887479034423828125 or approximately 1.886471450963509|
|7,8|77944080737315475738872989231498061716581907086912332111094410589976171097109942006628340703373831313603778172931728082882923066083824461234100024/40478768324118329441691972810958332627025107472900779123554591970065944251888701699913032058140188826951257054585610906981312309099633640112302273 or approximately 1.925554654064766|
|7,9|424585367057432264850800708986774567281949830985271926136162143304858385480745731037112485243863774973694797015945013962298066791261359536045085711843790181063204169461934429417259207616074966637324/221847229766197478403421783881049793815650963639566693965366194555565712210750929595597496482641815966343124071171700432114025866407833868267581852786347181926043539267517620844748312185516357421875 or approximately 1.9138637318342826|
|8,9|698705908672625095399049767521972744313322715252996672792057040722594716031215308996691926482611255527640154140159120583700586195467744559027938445/364308914917064964975227755298624993643225967256107012111991327730593498266998315299217288523261699442561313491270498162831810781896702761010720457 or approximately 1.9178940730332819|

Putting the sluggers 3rd and 4th maximizes the average runs scored over 9
innings at approximately 1.998 runs.

Putting the sluggers 6th and 9th minimizes the average runs scored over 9
innings at approximately 1.886 runs.

Making the rounds
-----------------
Splitting off the greatest number in its own subset, the average of averages
is $(N/2 + N) / 2 = 3N/4$.

Splitting off the next greatest number $((N-1)/2 + N + N - 1)/3 = 5N/6 - 1/2$.

Splitting off the $n$ greatest numbers into their own subsets,
$((N+1-n)/2 + nN - (n-1)n/2)/(n+1) = (1-1/(2n+2))N + (1-n)/2$.

That's maximized at $2N/(2n+2)^2 - 1/2 = 0$, or $(n+1)^2 = N$, or
$n = \sqrt{N} - 1$.

For $N = 12$, that's when $n = \sqrt{12} - 1$.  The nearest whole numbers are
$n = 2$ and $n = 3$, and the average of averages for both $n = 2$ and $n = 3$
is 19/2.  (For $N = 13$, $n = \sqrt{13} - 1$, for which the nearest whole
numbers are also $n = 2$ and $n = 3$, and the average of averages for $n = 2$
is 31/3, or about 10.333, which is less than the average of averages for
$n = 3$, which is 83/8, or 10.375.)
