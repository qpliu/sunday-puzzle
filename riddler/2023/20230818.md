2023-08-18 Fiddler
==================
If there are $n < 3$ runners on base and $m < 3$ outs and the slugger is due up
after $p > 0$ at-bats, the average number of runs scored is

$$ R(n,m,p) = R(n+1,m,p-1)/3 + 2R(n,m+1,p-1)/3 $$

If there are 3 runners on base and $m > 3$ outs and the slugger is due up
after $p > 0$ at bats, the average number of runs scored is

$$ R(3,m,p) = (1+R(3,m,p-1))/3 + 2R(3,m+1,p-1)/3 $$

If there are $n \le 3$ runners on base and $m < 3$ outs and the slugger is up,
the average number of runs scored is

$$ R(n,m,0) = (1+n+R(0,m,8))/10 + 9R(n,m+1,8)/10 $$

Also,

$$ R(n,3,p) = 0 $$

Instead of the inverting the matrix, I'll use [code](20230818.hs) and add a
special case of the slugger batting with 3 on to avoid the infinite loop
of batting through the lineup without any outs,

$$ R(3,m,0) = 9R(3,m+1,8)/10 + \frac{1}{10}(4 + 2R(0,m+1,8)/3 + \frac{1}{3}(2R(1,m+1,7)/3 + \frac{1}{3}(2R(2,m+1,6)/3 + \frac{1}{3}(2R(3,m+1,5)/3 + \frac{1}{3}(1 + 2R(3,m+1,4)/3 + \frac{1}{3}(1 + 2R(3,m+1,3)/3 + \frac{1}{3}(1 + 2R(3,m+1,2)/3 + \frac{1}{3}(1 + 2R(3,m+1,1)/3 + \frac{1}{3}R(3,m,0))))))))) $$

or

$$ R(3,m,0) = 9R(3,m+1,8)/10 + \frac{1}{10}(4 + 2R(0,m+1,8)/3 + \frac{1}{3}(2R(1,m+1,7)/3 + \frac{1}{3}(2R(2,m+1,6)/3 + \frac{1}{3}(2R(3,m+1,5)/3 + \frac{1}{3}(1 + 2R(3,m+1,4)/3 + \frac{1}{3}(1 + 2R(3,m+1,3)/3 + \frac{1}{3}(1 + 2R(3,m+1,2)/3 + \frac{1}{3}(1 + 2R(3,m+1,1)/3)))))))) + \frac{1}{10}\frac{1}{3^8}R(3,m,0) $$

Solving for $R(0,0,p)$ for the different values of $p$ gives

|slugger slot|average runs|
|------------|------------|
|1|30705914956035111881/166764191515406259210 or approximately 0.18412774755183814|
|2|105427777956070711373/500292574546218777630 or approximately 0.21073224612957137|
|3|359265737504488261637/1500877723638656332890 or approximately 0.23937042428313318|
|4|60071937158948365151/250146287273109388815 or approximately 0.2401472267040362|
|5|10142292288127550275/50029257454621877763 or approximately 0.2027272201136891|
|6|96496593331716392/617645153760763923 or approximately 0.1562330615631981|
|7|311913520655760143/1852935461282291769 or approximately 0.16833480019854863|
|8|968596836828171410/5558806383846875307 or approximately 0.17424547104982469|
|9|2951075404024859021/16676419151540625921 or approximately 0.17696097568717134|

Putting the slugger 4th maximizes the average runs scored in the
first inning at approximately 0.240 runs.

Putting the slugger 6th minimizes the average runs scored in the
first inning at approximately 0.156 runs.

Extra credit
------------
For a given inning with the sluggers due up after $p$ and $q > p$ batters,
the next inning will start with the sluggers due up of after $p'$ and $q' > p'$
batters with probability $P(p,q,p',q')$ and scoring $R(p,q,p',q')$ runs
on average.

The total average score for sluggers due up after $p$ and $q$ batters in
the $n$-th inning is

$$ S(n,p,q) = \sum_{p',q'} P(p,q,p',q')(R(p,q,p',q') + S(n+1,p',q')) $$

where $S(10,p,q) = 0$.

|sluggers|average runs|
|--------|------------|
|1,2|72552644218654860119122926992084135641344643855638773789736285687599949535209544773467910770894297234469155903264089468412449908277354570058934363/37480341040850305038603678528665122802801025437871091781069066638949948381378427499919474127907582247177089865357047136093807693610771888992872475 or approximately 1.9357519756711605|
|1,3|2413397723733061247838600849670513113205482904387325649200449800446780819674632915168603602413398939627907783912138047951200373073418708232263246889747297152819521267758806322760291038936598627678411/1232484609812208213352343243783609965642505353553148299807589969753142845615282942197763869348010088701906244839842780178411254813376854823708788071035262121811352995930653449137490623252868652343750 or approximately 1.9581564788064874|
|1,4|3591105298905042378188256687948135993869415539898671557260703056709110663160332327457467492495485702927646246660950306006033388245124124995418317254779391858111714289681210986999307848247283517279282/1848726914718312320028514865675414948463758030329722449711384954629714268422924413296645804022015133052859367259764170267616882220065282235563182106552893182717029493895980173706235934879302978515625 or approximately 1.9424747215584373|
|1,5|10762726142565881922024909890492398613013676142281395982199595416863183651583243980263739643485609325404221547128642521368110131406273765596674851213650336390548940519283617169612829151076117663437864/5546180744154936960085544597026244845391274090989167349134154863889142805268773239889937412066045399158578101779292510802850646660195846706689546319658679548151088481687940521118707804637908935546875 or approximately 1.9405653438014274|
|1,6|78996372970781785601904563527089758091831959532659282921769614435206494717500041378688925204346835019111072888675428393266550084895410865613000584167020397633585846862188045154998799957360007521154/41082820327073607111744774792786998854750178451771609993586332325104761520509431406592128978267002956730208161328092672613708493779228494123626269034508737393711766531021781637916354108428955078125 or approximately 1.9228566184567206|
|1,7|157454832135483509709638300876194817083280656540160258587727188344978722498837290901449734434673093777926774579270375902856129455591292327922169228287279937960691061141313380788183932952608985144789/82165640654147214223489549585573997709500356903543219987172664650209523041018862813184257956534005913460416322656185345227416987558456988247252538069017474787423533062043563275832708216857910156250 or approximately 1.916309918378713|
|1,8|15745885881344381964072973773166904598565005046472223004569308771722056530005123451683826838568331721296129436986315635759813231351517536513704990162302781764816247481183954149799615481827572960581/8216564065414721422348954958557399770950035690354321998717266465020952304101886281318425795653400591346041632265618534522741698755845698824725253806901747478742353306204356327583270821685791015625 or approximately 1.9163589252133004|
|1,9|5692234406005257400822068970627338637710993871312877235170284444845072068322111978928305212229073244892194117122520893563182566962306602589809459/2998427283268024403088294282293209824224082035029687342485525331115995870510274199993557930232606579774167189228563770887504615488861751119429798 or approximately 1.8984066873221679|
|2,3|74494884932490096513319561539908954202673441880236252377761629539217203295275673095836647573210983045910692651901608942711528659742352025722339548/37480341040850305038603678528665122802801025437871091781069066638949948381378427499919474127907582247177089865357047136093807693610771888992872475 or approximately 1.9875722275658367|
|2,4|3650662292043573915986797228234212274862957647924633056002474201844411911395815447211515453048661109425702993715307662103671856738689259911280673528786294515381143472130917970196800616126100350903567/1848726914718312320028514865675414948463758030329722449711384954629714268422924413296645804022015133052859367259764170267616882220065282235563182106552893182717029493895980173706235934879302978515625 or approximately 1.9746898598054001|
|2,5|10775315341914826768561728790486357391825982703589736122390154257201318243690167703323326838185085907695944035956987462179843002009086071948963543397201938676782084859380266092627856898181613715033008/5546180744154936960085544597026244845391274090989167349134154863889142805268773239889937412066045399158578101779292510802850646660195846706689546319658679548151088481687940521118707804637908935546875 or approximately 1.9428352300402076|
|2,6|64771854606359554032237244802104227815494149630747958264911787679212680121750875618320472764326321915440689862690375735461439384800127254994040546613366634421798049452798231605904437725329468188854257/33277084464929621760513267582157469072347644545935004094804929183334856831612639439339624472396272394951468610675755064817103879961175080240137277917952077288906530890127643126712246827827453613281250 or approximately 1.946440189933765|
|2,7|241734198625178671677890433804613240615353273496806999445729763216512682377979229531378246783983995210807374477064665940191175036413779133361885645139147027477468546883739336146166458730904041932163/123248460981220821335234324378360996564250535355314829980758996975314284561528294219776386934801008870190624483984278017841125481337685482370878807103526212181135299593065344913749062325286865234375 or approximately 1.9613567317648806|
|2,8|95509066125595021100215044242706878613035976365199346241040552128307835528520538632101712795769556889618124377759292073598774406657292907291855665275713468293664652455688617299725089429959841425513/49299384392488328534093729751344398625700214142125931992303598790125713824611317687910554773920403548076249793593711207136450192535074192948351522841410484872454119837226137965499624930114746093750 or approximately 1.9373277638766537|
|2,9|236931489652411923424104071135555130724870749855913343848041621923537920505382443433320927628447455001174907836579536902269944413821111799143093284942572609002054344560502512934648233012569304129036/123248460981220821335234324378360996564250535355314829980758996975314284561528294219776386934801008870190624483984278017841125481337685482370878807103526212181135299593065344913749062325286865234375 or approximately 1.9223890324156891|
|3,4|29950009326339270724570514643455149420210888820834441158834058717649652528783074351099237670640477364131215072696743336131566886647245697907214813/14992136416340122015441471411466049121120410175148436712427626655579979352551370999967789651163032898870835946142818854437523077444308755597148990 or approximately 1.997714568131622|
|3,5|10918162966972868825480206631130089040906737635516485861821473140306114972105743154068188040026757108139471469330842372890362766312051199742788420285554429171867753441408808844173276347394552728169713/5546180744154936960085544597026244845391274090989167349134154863889142805268773239889937412066045399158578101779292510802850646660195846706689546319658679548151088481687940521118707804637908935546875 or approximately 1.968591264985262|
|3,6|64821659101927752552490058645561997146084669858269786902704016097688717748348593561917718224379459617594460726433898523696306132965621507331805842785570283764697318354122160741052021803015522530596049/33277084464929621760513267582157469072347644545935004094804929183334856831612639439339624472396272394951468610675755064817103879961175080240137277917952077288906530890127643126712246827827453613281250 or approximately 1.9479368503644794|
|3,7|198042808946906513249433983845311906020190715503046466367474994484660950363182772079585768011290741331439489826874985419298718390676030399709617106957376808063311317350464278413391260623578567254661047/99831253394788865281539802746472407217042933637805012284414787550004570494837918318018873417188817184854405832027265194451311639883525240720411833753856231866719592670382929380136740483482360839843750 or approximately 1.9837756435225147|
|3,8|731870406975968025857695654834889013527493364435420576376275202178071486806412829285213510788574751234208612028596763222767725598150386088022100713981649800751767648867372808493922562881179614164808/369745382943662464005702973135082989692751606065944489942276990925942853684584882659329160804403026610571873451952834053523376444013056447112636421310578636543405898779196034741247186975860595703125 or approximately 1.9793902526904088|
|3,9|1436322050832620381345705648222435500646652486981892684748914845577946100107616329445922984903128838405183929638071483035641492558968652369361353956292204231657936991509954355520635971348230198073753/739490765887324928011405946270165979385503212131888979884553981851885707369169765318658321608806053221143746903905668107046752888026112894225272842621157273086811797558392069482494373951721191406250 or approximately 1.9423123547853343|
|4,5|147366104794303280826674984458894372816772513149907229749799101160916642989479958747177175361731483211209713970062691281055121068146040310100054461/74960682081700610077207357057330245605602050875742183562138133277899896762756854999838948255815164494354179730714094272187615387221543777985744950 or approximately 1.9659120048252372|
|4,6|3602947310912733847264466799078472319863432816253206441494670846953974203497301423346193525006980731269966708130840231429504713282264738614392466186289761246470544925159045236356739769894166462259782/1848726914718312320028514865675414948463758030329722449711384954629714268422924413296645804022015133052859367259764170267616882220065282235563182106552893182717029493895980173706235934879302978515625 or approximately 1.948880217098862|
|4,7|10872869624229613087329059217919192868045731340243772845579318929455686637293473162371219896043071096777268156698707255465189306099115293967093363443422641610630113478526787171653080550830078145435918/5546180744154936960085544597026244845391274090989167349134154863889142805268773239889937412066045399158578101779292510802850646660195846706689546319658679548151088481687940521118707804637908935546875 or approximately 1.960424682460704|
|4,8|32945671298626789367786935832328608996539151048956380738917102269046054368940436770110443161522208077279776342231169983354289078520444341429706345141913164424088193650198541396492159729141875602691053/16638542232464810880256633791078734536173822272967502047402464591667428415806319719669812236198136197475734305337877532408551939980587540120068638958976038644453265445063821563356123413913726806640625 or approximately 1.9800815983953097|
|4,9|2180767435462516306875836776868255198005334913040154674083879332980431115778120846400396655366093209322116194166877138394324514043621454533692234904952809701157357259389103199152888792069005647434539/1109236148830987392017108919405248969078254818197833469826830972777828561053754647977987482413209079831715620355858502160570129332039169341337909263931735909630217696337588104223741560927581787109375 or approximately 1.9660082641201377|
|5,6|43158891459000135113104444271453025509066916805118655818965716330502931233276234540302261675805624977850377310231518607253142483355623917006165806/22488204624510183023162207117199073681680615262722655068641439983369969028827056499951684476744549348306253919214228281656284616166463133395723485 or approximately 1.9191790620741997|
|5,7|3575917634949914094760584313803379913611769836453620473405689917705615590124755644412538448183463737407488330004896043986463218032696752514010939383277865619232089932341547921531184958270736221230066/1848726914718312320028514865675414948463758030329722449711384954629714268422924413296645804022015133052859367259764170267616882220065282235563182106552893182717029493895980173706235934879302978515625 or approximately 1.9342595201491786|
|5,8|10697639687749728183285848603872603459922874993767565948134114222976940055948998901485200425787585033398814031177393286580158060763687531705729425652924198361904971467082212808771364337682556266014784/5546180744154936960085544597026244845391274090989167349134154863889142805268773239889937412066045399158578101779292510802850646660195846706689546319658679548151088481687940521118707804637908935546875 or approximately 1.9288299789046472|
|5,9|3184664970497176003170332970270301277886911464121934627300491841280990799047442690857874263075954964490147148123200412929568978129379617521317755985323396016979602782129960268604776169056937895732/1643312813082944284469790991711479954190007138070864399743453293004190460820377256263685159130680118269208326453123706904548339751169139764945050761380349495748470661240871265516654164337158203125 or approximately 1.9379542015026165|
|6,7|25684135515078043156958807925608103845947936855614834040237211335857221955429437087962964849361955697623843294157654990379099714995817972850270739/13492922774706109813897324270319444209008369157633593041184863990021981417296233899971010686046729608983752351528536968993770769699877880037434091 or approximately 1.903526459309886|
|6,8|1041439796091216676294384265402181099764310762724090737590235285328611861849024147615026317804985973844103968001919838365600472155062082748718456684305471720622975812149161454912099495547881288847/547770937694314761489930330570493318063335712690288133247817764334730153606792418754561719710226706089736108817707902301516113250389713254981683587126783165249490220413623755172218054779052734375 or approximately 1.9012322933284118|
|6,9|3100067339476331993022593665287414609811787999030217238876902652878549801073695883918648236029702034042427119976853532318875333797261585052326964936880610080169902410677493906576500263195741539503/1643312813082944284469790991711479954190007138070864399743453293004190460820377256263685159130680118269208326453123706904548339751169139764945050761380349495748470661240871265516654164337158203125 or approximately 1.886474270020713|
|7,8|25981391498990938145871128312482330060337549023996178712014177275041530166180430210930746252437097411273895976864766316063668179637207812311756136/13492922774706109813897324270319444209008369157633593041184863990021981417296233899971010686046729608983752351528536968993770769699877880037434091 or approximately 1.9255569703323112|
|7,9|15725402996815818701944551265726978572362780225307958370295854953468709003267242743431756693463075092827383475473029743650280351238360582263157233937822804594901714455709030682270535691493847249738/8216564065414721422348954958557399770950035690354321998717266465020952304101886281318425795653400591346041632265618534522741698755845698824725253806901747478742353306204356327583270821685791015625 or approximately 1.913866048097575|
|8,9|2875336208941879294552361424693187341529972719748156286961192457426822977201364636581070170580254831733077951998123525922049975414714328353894085/1499213641634012201544147141146604912112041017514843671242762665557997935255137099996778965116303289887083594614281885443752307744430875559714899 or approximately 1.917896241797809|

Putting the sluggers 3rd and 4th maximizes the average runs scored over 9
innings at approximately 1.998 runs.

Putting the sluggers 6th and 9th minimizes the average runs scored over 9
innings at approximately 1.886 runs.

Making the rounds
-----------------
Splitting off the greatest number in its own subset, the average of averages
is $(N/2 + N) / 2 = 3N/4$.

Splitting off the next greatest number $((N-1)/2 + N + N - 1)/3 = 5N/6 - 1/2$.

Splitting off the $n$ greatest numbers into their own subsets,
$((N+1-n)/2 + nN - (n-1)n/2)/(n+1) = (1-1/(2n+2))N + (1-n)/2$.

That's maximized at $2N/(2n+2)^2 - 1/2 = 0$, or $(n+1)^2 = N$, or
$n = \sqrt{N} - 1$.

For $N = 12$, that's when $n = \sqrt{12} - 1$.  The nearest whole numbers are
$n = 2$ and $n = 3$, and the average of averages for both $n = 2$ and $n = 3$
is 19/2.  (For $N = 13$, $n = \sqrt{13} - 1$, for which the nearest whole
numbers are also $n = 2$ and $n = 3$, and the average of averages for $n = 2$
is 31/3, or about 10.333, which is less than the average of averages for
$n = 3$, which is 83/8, or 10.375.)
